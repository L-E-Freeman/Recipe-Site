{% extends 'recipes/base.html' %}

{% block content %}
<!-- Load static must come after block content.-->
{% load static %}

<link rel="stylesheet" type="text/css" href="{% static 'recipes/create_recipe_style.css' %}">


    <form action="." method="post">
        {% csrf_token %}

        <h1>Recipe Information</h1>

        {% if error_message %} 
        <strong>{{ error_message }}</strong>
        {% endif %}
        <div id="recipeinfo">
            <p>
                {{ form.recipe_name.label_tag }}
                {{ form.recipe_name}}
            </p>
            <p>
                {{ form.source.label_tag }}
                {{ form.source }}
            </p>
            <p>
                {{ form.prep_time.label_tag }}
                {{ form.prep_time }}
            </p>
            <p>
                {{ form.cooking_time.label_tag }}
                {{ form.cooking_time }}
            </p>
            <p>
                {{ form.servings.label_tag }}
                {{ form.servings }}
            </p>
        </div>

        <hr>

        <h2>Ingredients</h2>

        {{ iformset.management_form }}
        <div id=ingredientform>
            {% for i_form in iformset %}
            <div class = ingredientinfo>
                {{ i_form.as_p }}
            </div>
        {% endfor %}
        </div>

        <input type="button" value="Add More" id="add_more">

        <script>
            let formCount = {{ iformset.total_form_count }}
            let emptyForm = '{{ iformset.empty_form.as_p|escapejs }}'
        </script>

        <script type="text/javascript" src="/static/recipes/add_more.js"></script>
    
        <hr>
        
        <h2>Method</h2>
        <div id="methodinfo">
        {{ mformset.management_form }}
        {% for m_form in mformset %}
            Step {{ forloop.counter }}. {{ m_form.as_p }} 
        {% endfor %}
        </div>
        <input type="submit" value="Submit">
    </form>
{% endblock content %}

<!--The form action should go to the same view that serves the form - as a 
post request. View will process and then you are sent to thank you page.-->